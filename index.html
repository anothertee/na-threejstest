<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Nouro Airways Cabin Model</title>

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@100&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/main.css">

        <script src="js/three.js"></script>
        <script src="js/OBJLoader.js"></script>
        <script src="js/MTLLoader.js"></script>
        <script src="js/OrbitControls.js"></script>

	</head>
	<body>
        
        <h1>Nouro Airways Cabin</h1>

        <div id="controls">
            <img id="img-1" src="img/pan_lrg.png">
            <img id="img-2" src="img/zoom_lrg.png">
        </div>


        <script>

            const container = document.createElement( 'div' );
            document.body.appendChild( container );

            const renderer = new THREE.WebGLRenderer();
            renderer.outputEncoding = THREE.sRGBEncoding;
            renderer.setPixelRatio( window.devicePixelRatio );
            renderer.setSize( window.innerWidth, window.innerHeight );
            renderer.setClearColor('#141414');
            container.appendChild( renderer.domElement );


            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.1, 10000 )
            camera.position.z = 3;
            camera.position.y = 2;
            camera.position.x = -3;


            const hemiLight = new THREE.HemisphereLight( 0xffffff, 0.2 );
            hemiLight.position.set( 0, 300, 0 );
            scene.add( hemiLight );

            const dirLight = new THREE.DirectionalLight( 0xffffff, 1 );
            dirLight.position.set( 75, 300, -75 );
            scene.add( dirLight );

            var controls;

            controls = new THREE.OrbitControls( camera );
            controls.addEventListener( 'change', 'render' );


            // load obj 
            const onProgress = function ( xhr ) {

                if ( xhr.lengthComputable ) {

                    const percentComplete = xhr.loaded / xhr.total * 100;
                    console.log( Math.round( percentComplete, 2 ) + '% downloaded' );

                }

                };

                var mtl_loader = new THREE.MTLLoader();
                    mtl_loader.load('models/final_scene_with-texture-info.mtl',
                        function(materials) {
                            materials.preload()
                                var obj_loader = new THREE.OBJLoader();
                                // obj_loader.setMaterials(materials)
                                obj_loader.load('models/envBlock.obj',
                                function(object) {
                                    let mesh = object.children[0]
                                    scene.add(mesh);
                                    
                                    object.scale.x = 1;
                                    object.scale.y = 1;
                                    object.scale.z = 1;

                                    scene.add(object)

                                }, null, function(error) {alert(error)}
                            )
                        }, null, function(error) {alert(error)}
                    );




            // rendering the scene
            function animate() {
                requestAnimationFrame( animate );
                renderer.render( scene, camera );
            }

            animate();
        </script>

    </body>
        
</html>
